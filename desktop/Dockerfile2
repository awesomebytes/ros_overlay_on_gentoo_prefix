# Pull ros-melodic/ros_base already emerged and the first part to emerge desktop
FROM awesomebytes/roogp_ros_melodic_desktop_1

# cause of https://github.com/ros/ros-overlay/issues/725
# Workaround cause of https://bugs.gentoo.org/704624 dev-python/PyQt5-5.14.0 doesn't emerge, go to previous
# RUN echo ">=dev-python/PyQt5-5.13.2" >> $EPREFIX/etc/portage/package.mask
RUN $PREFIXED emerge dev-python/PyQt5[gui,widgets]
RUN cd /tmp/gentoo/usr/bin && \
    unlink qmake && \
    ln -s /tmp/gentoo/usr/lib64/qt5/bin/qmake qmake
RUN qt_install_libs_path=/tmp/gentoo/usr/lib; sed -i 's@$$\[QT_INSTALL_LIBS\]@'$qt_install_libs_path'@' $EPREFIX/usr/lib/libQt5Gui.prl
RUN cd /tmp/gentoo/usr/lib/cmake/Qt5Gui; find ./ -type f -exec sed -i -e 's@/home/user@/tmp@g' {} \;


ENTRYPOINT ["/bin/bash"]
